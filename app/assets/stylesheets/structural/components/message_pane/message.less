@import "structural/variables.less";
@import "structural/mixins.less";

@breathing-room: 0.5rem;
@unread-indicator-color: #80a0c0;
@unread-indicator-width: 2px;

@image-height: 13rem;
@image-width: 20rem;
@image-background-color: @standard-background-color;
@image-shadow-color: @standard-shadow-color;

.system-message() {
  .small-light-font();
  text-align: center;

  & + .message-message {
    margin-top: @breathing-room;
  }

  &:first-child {
    margin-top: @breathing-room;
  }
}

.user-message() {
  .standard-border-top();

  margin: @breathing-room;
  margin-top: 0;
  padding: @breathing-room;

  white-space: pre-line;
  word-break: break-word;

  .message-info {
    margin-bottom: @breathing-room;

    .message-sender {
      font-weight: bold;
    }

    .message-details {
      .small-light-font();
      float: right;
    }
  }

  .message-text {
    padding-bottom: 1rem;
    position: relative;

    &:last-child {
      padding-bottom: 0;
    }

    .message-link {
      .unstyled-anchor(@link-font-color);
    }

    .message-image-link {
      .standard-border();

      height: @image-height;
      max-width: @image-width;
      display: block;
      background-repeat: no-repeat;
      -webkit-background-size: cover;
      -moz-background-size: cover;
      -o-background-size: cover;
      background-size: cover;
      background-color: @image-background-color;
      margin: @breathing-room 0;
      box-shadow: 0 0.2rem 0.4rem @image-shadow-color;
    }
  }

  &.current-users-message {
    .standard-border();
    background-color: @standard-background-color;

    &+ .message-message:not(.current-users-message) {
      border: none;
    }
  }

  &:not(.current-users-message) {
    .unread-message-text:before {
      content: "";
      position: absolute;
      width: @unread-indicator-width;
      top: 0;
      bottom: 0;
      left: -@breathing-room;
      background-color: @unread-indicator-color;
    }
  }
}

.email-delivery-error-message,
.retitle-message,
.update-users-message,
.update-viewers-message {
  .system-message();
}

.message-message {
  .user-message();
}

.unknown-message {
  .system-message();
  color: @error-color;
}
